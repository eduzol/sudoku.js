/*! sudoku 2015-01-26  eduzol _at _ gmail */
var VIEW=function(){var a={},b="",c=function(){},d=function(a,b,c){$(".grid td[data-column='"+c+"'][data-row='"+b+"'][data-section='"+a+"'] span").attr("contenteditable","false"),$(".grid td[data-column='"+c+"'][data-row='"+b+"'][data-section='"+a+"']").toggleClass("notEditable")},e=function(a,b,c,d){d||(d="&nbsp;");var e=$("<span contenteditable='true'>"+d+"</span>");$(".grid td[data-column='"+c+"'][data-row='"+b+"'][data-section='"+a+"']").empty().append(e)},f=function(a){var c=a.code,d={};switch(c){case 0:d=$(".grid td[data-column='"+a.column+"']"),d.toggleClass("invalid"),e(a.section,a.row,a.column,b),setTimeout(function(){d.toggleClass("invalid")},1500);break;case 1:d=$(".grid td[data-row='"+a.row+"']"),d.toggleClass("invalid"),e(a.section,a.row,a.column,b),setTimeout(function(){d.toggleClass("invalid")},1500);break;case 2:d=$(".grid td[data-section='"+a.section+"']"),d.toggleClass("invalid"),e(a.section,a.row,a.column,b),setTimeout(function(){d.toggleClass("invalid")},1500)}},g=function(){$(this).children("span").focus()},h=function(a){var c=a.charCode,d=!1,e=$(this).children("span").text();if(c>=49&&57>=c&&(d=!0),!d)return void a.preventDefault();var f=$(this),g=f.attr("data-section"),h=f.attr("data-row"),i=f.attr("data-column");e=parseInt($(this).children("span").text());var j=$.isNumeric(e);b=e;var k=String.fromCharCode(c);e&&j&&$(this).children("span").text(""),SUDOKU.setMove(g,h,i,k)},j=function(){SUDOKU.setMove(1,1,1,5),e(1,1,1,5),d(1,1,1),SUDOKU.setMove(1,1,2,3),e(1,1,2,3),d(1,1,2),SUDOKU.setMove(1,2,1,6),e(1,2,1,6),d(1,2,1),SUDOKU.setMove(1,3,2,9),e(1,3,2,9),d(1,3,2),SUDOKU.setMove(1,3,3,8),e(1,3,3,8),d(1,3,3),SUDOKU.setMove(4,4,1,8),e(4,4,1,8),d(4,4,1),SUDOKU.setMove(4,5,1,4),e(4,5,1,4),d(4,5,1),SUDOKU.setMove(4,6,1,7),e(4,6,1,7),d(4,6,1),SUDOKU.setMove(7,7,2,6),e(7,7,2,6),d(7,7,2),SUDOKU.setMove(2,1,5,7),e(2,1,5,7),d(2,1,5),SUDOKU.setMove(2,2,4,1),e(2,2,4,1),d(2,2,4),SUDOKU.setMove(2,2,5,9),e(2,2,5,9),d(2,2,5),SUDOKU.setMove(2,2,6,5),e(2,2,6,5),d(2,2,6),SUDOKU.setMove(3,3,8,6),e(3,3,8,6),d(3,3,8),SUDOKU.setMove(5,4,5,6),e(5,4,5,6),d(5,4,5),SUDOKU.setMove(5,5,4,8),e(5,5,4,8),d(5,5,4),SUDOKU.setMove(5,5,6,3),e(5,5,6,3),d(5,5,6),SUDOKU.setMove(5,6,5,2),e(5,6,5,2),d(5,6,5),SUDOKU.setMove(6,4,9,3),e(6,4,9,3),d(6,4,9),SUDOKU.setMove(6,5,9,1),e(6,5,9,1),d(6,5,9),SUDOKU.setMove(6,6,9,6),e(6,6,9,6),d(6,6,9),SUDOKU.setMove(8,8,4,4),e(8,8,4,4),d(8,8,4),SUDOKU.setMove(8,8,5,1),e(8,8,5,1),d(8,8,5),SUDOKU.setMove(8,8,6,9),e(8,8,6,9),d(8,8,6),SUDOKU.setMove(8,9,5,8),e(8,9,5,8),d(8,9,5),SUDOKU.setMove(9,7,7,2),e(9,7,7,2),d(9,7,7),SUDOKU.setMove(9,7,8,8),e(9,7,8,8),d(9,7,8),SUDOKU.setMove(9,8,9,5),e(9,8,9,5),d(9,8,9),SUDOKU.setMove(9,9,8,7),e(9,9,8,7),d(9,9,8),SUDOKU.setMove(9,9,9,9),e(9,9,9,9),d(9,9,9)},k=function(){var a=0,b=0,c=1,d=[],e=1,f=!1;for(i=0;i<81;i++){f=!1;var g={};i%3===0&&b++,i%9===0&&(c=1,a++,b=e),i%27===0&&0!==i&&(e+=3,b=e),(i+1)%9===0&&i+1!==0&&(f=!0),g.endtr=f,g.index=i+1,g.row=a,g.column=c,g.section=b,d.push(g),c++}return d},l=function(a){var b=$("#template").html(),c=Mustache.render(b,{elements:a});$("#target").html(c)};return a.init=function(){SUDOKU.init({succesfulMove:c,failureMove:f,completed:c});var a=k();l(a),$(".grid td").click(g),$(".grid td").keypress(h),j()},$(document).ready(function(){a.init()}),a}(),SUDOKU=function(){var a={},b=9,c=[],d=[],e=[],f={},g={},h={message:"success",value:""},i={code:0,message:"columnValidationError",value:""},j={code:1,message:"rowValidationError",value:""},k={code:2,message:"sectionValidationError",value:""},l={code:3,message:"invalidNumber",value:""},m=function(a,b){var d=c[a][b];return d?!1:!0},n=function(a,b){var c=d[a][b];return c?!1:!0},o=function(a,b){var c=e[a][b];return c?!1:!0},p=function(a){return a>0&&9>=a?!0:!1};return a.init=function(a){f=a.succesfulMove,onfailureMove=a.failureMove,g=a.completed;for(var h=0;b>=h;h++)c[h]=[],d[h]=[],e[h]=[]},a.setMove=function(a,b,g,q){if(!p(a))return l.value=a,void onfailureMove(l);if(!p(g))return l.value=g,void onfailureMove(l);if(!p(b))return l.value=b,void onfailureMove(l);var r=m(b,q);if(!r)return j.value=q,j.section=a,j.column=g,j.row=b,void onfailureMove(j);var s=n(g,q);if(!s)return i.value=q,i.section=a,i.column=g,i.row=b,void onfailureMove(i);var t=o(a,q);return t?void(r&&s&&t&&(c[b][q]=!0,d[g][q]=!0,e[a][q]=!0,h.value=q,h.section=a,h.column=g,h.row=b,f(h))):(k.value=q,k.section=a,k.column=g,k.row=b,void onfailureMove(k))},a}();